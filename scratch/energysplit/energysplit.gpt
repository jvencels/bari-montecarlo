set terminal pngcairo
set output 'energysplit.png'

a = 13.0
nbins = 15
binwidth = 1/(nbins*1.0)
set boxwidth binwidth*.7
sum = 0

s(x)          = ((sum=sum+1), NaN)
bin(x, width) = width*floor(x/width) + binwidth/2.0

set xlabel 'Energy, eV'
set ylabel 'Probability, %'

#set xrange [0.1:3e2]
#set logscale x

K = 1
f(x) = a/atan(1e2/a)/(a*a+x*x)

plot K*f(x) title 'Analytical p(E)', \
    "energysplit.out" u ($1):(s($1)) notitle, \
    "energysplit.out" u (bin($1, binwidth)):(K/(sum*binwidth)) smooth freq w boxes title "Generated values"

#plot "energysplit.out" u (bin($1, binwidth)):(1.0) smooth freq w boxes